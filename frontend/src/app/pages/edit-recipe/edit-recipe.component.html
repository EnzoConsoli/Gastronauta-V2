<div class="form-container">
  <div class="form-card">
    <h1 class="title">Editar Receita</h1>

    <div *ngIf="isLoading" class="loading">Carregando...</div>
    <div *ngIf="error" class="error">{{ error }}</div>

    <form *ngIf="!isLoading" [formGroup]="recipeForm" (ngSubmit)="onSubmit()">

      <div class="image-preview-container">
        <img [src]="currentImageUrl || '/assets/images/placeholder-recipe.png'" alt="Preview da Receita" class="image-preview">
      </div>
      

      <div class="form-group">
        <label for="imagemReceita" class="file-label">Trocar Imagem da Receita</label>
        <input id="imagemReceita" type="file" (change)="onFileChange($event)" accept="image/png, image/jpeg, image/webp">
      </div>

      <div class="form-group">
        <label for="prato">Nome do Prato</label>
        <input id="prato" type="text" formControlName="prato" maxlength="40">
        <small class="text-counter">{{ recipeForm.get('prato')?.value?.length || 0 }}/40</small>
      </div>

      <div class="form-group">
        <label for="descricao">Descrição Curta</label>
        <input id="descricao" type="text" formControlName="descricao" maxlength="200">
        <small class="text-counter">{{ recipeForm.get('descricao')?.value?.length || 0 }}/200</small>
      </div>

      <div class="form-group">
        <label for="ingredientes">Ingredientes</label>
        <textarea id="ingredientes" formControlName="ingredientes" rows="8" maxlength="1500"></textarea>
        <small class="text-counter">{{ recipeForm.get('ingredientes')?.value?.length || 0 }}/1500</small>
      </div>

      <div class="form-group">
        <label for="preparacao">Modo de Preparo</label>
        <textarea id="preparacao" formControlName="preparacao" rows="8" maxlength="3000"></textarea>
        <small class="text-counter">{{ recipeForm.get('preparacao')?.value?.length || 0 }}/3000</small>
      </div>

      <div class="details-row">
        <div class="form-group">
          <label for="dificuldade">Dificuldade</label>
          <select id="dificuldade" formControlName="dificuldade">
            <option value="Fácil">Fácil</option>
            <option value="Média">Média</option>
            <option value="Difícil">Difícil</option>
          </select>
        </div>
        <div class="form-group">
          <label for="custo">Custo</label>
          <select id="custo" formControlName="custo">
            <option value="Baixo">Baixo</option>
            <option value="Médio">Médio</option>
            <option value="Alto">Alto</option>
          </select>
        </div>
      </div>

      <div class="details-row">
        <div class="form-group">
          <label for="tempo_preparo">Tempo de Preparo</label>
          <input id="tempo_preparo" type="text" formControlName="tempo_preparo">
        </div>
        <div class="form-group">
          <label for="rendimento">Rendimento</label>
          <input id="rendimento" type="text" formControlName="rendimento">
        </div>
        <div class="form-group">
          <label for="cozimento">Tempo de Cozimento</label>
          <input id="cozimento" type="text" formControlName="cozimento">
        </div>
      </div>
      <h2>Tags da Receita</h2>

<tags-selector
  [(selected)]="selectedTags">
</tags-selector>


      <div class="button-group">
        <button type="button" class="btn btn-secondary" [routerLink]="['/receita', recipeId]">Cancelar</button>
        <button type="submit" class="btn btn-primary" [disabled]="recipeForm.invalid || isLoading">
          {{ isLoading ? 'Salvando...' : 'Salvar Alterações' }}
        </button>
      </div>

    </form>
  </div>
</div>
